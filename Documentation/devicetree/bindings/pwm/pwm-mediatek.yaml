# SPDX-License-Identifier: (GPL-2.0-only OR BSD-2-Clause)
# Copyright (C) 2020 SiFive, Inc.
%YAML 1.2
---
$id: http://devicetree.org/schemas/pwm/pwm-mediatek.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: MediaTek PWM controller

maintainers:
  - Thierry Reding <thierry.reding@gmail.com>
  - Lee Jones <lee.jones@linaro.org>
  - Matthias Brugger <matthias.bgg@gmail.com>

properties:
  compatible:
    oneOf:
      - enum:
          - mediatek,mt2712-pwm
          - mediatek,mt7622-pwm
          - mediatek,mt7623-pwm
          - mediatek,mt7628-pwm
          - mediatek,mt7629-pwm
          - mediatek,mt8183-pwm
          - mediatek,mt8365-pwm
          - mediatek,mt8516-pwm

  reg:
    maxItems: 1

  clocks:
    minItems: 3
    maxItems: 10

  clock-names: true

  "#pwm-cells":
    const: 2

  interrupts:
    maxItems: 1

required:
  - compatible
  - reg
  - clocks
  - clock-names
  - "#pwm-cells"

allOf:
  - if:
      properties:
        compatible:
          contains:
            const: mediatek,mt2712-pwm
    then:
      properties:
        clock-names:
          items:
            - const: top
            - const: main
            - const: pwm1
            - const: pwm2
            - const: pwm3
            - const: pwm4
            - const: pwm5
            - const: pwm6
            - const: pwm7
            - const: pwm8
  - if:
      properties:
        compatible:
          contains:
            const: mediatek,mt7622-pwm
    then:
      properties:
        clock-names:
          items:
            - const: top
            - const: main
            - const: pwm1
            - const: pwm2
            - const: pwm3
            - const: pwm4
            - const: pwm5
            - const: pwm6
  - if:
      properties:
        compatible:
          contains:
            const: mediatek,mt7623-pwm
    then:
      properties:
        clock-names:
          items:
            - const: top
            - const: main
            - const: pwm1
            - const: pwm2
            - const: pwm3
            - const: pwm4
            - const: pwm5
  - if:
      properties:
        compatible:
          contains:
            const: mediatek,mt7629-pwm
    then:
      properties:
        clock-names:
          items:
            - const: top
            - const: main
            - const: pwm1

additionalProperties: false

examples:
  - |
    #include <dt-bindings/clock/mt2701-clk.h>
    pwm0: pwm@11006000 {
      compatible = "mediatek,mt7623-pwm";
      reg = <0x11006000 0x1000>;
      #pwm-cells = <2>;
      clocks = <&topckgen CLK_TOP_PWM_SEL>,
        <&pericfg CLK_PERI_PWM>,
        <&pericfg CLK_PERI_PWM1>,
        <&pericfg CLK_PERI_PWM2>,
        <&pericfg CLK_PERI_PWM3>,
        <&pericfg CLK_PERI_PWM4>,
        <&pericfg CLK_PERI_PWM5>;
      clock-names = "top", "main", "pwm1", "pwm2",
                    "pwm3", "pwm4", "pwm5";
      pinctrl-names = "default";
      pinctrl-0 = <&pwm0_pins>;
    };
